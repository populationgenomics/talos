// name this cohort/dataset
params.cohort = "cohort"

// optional, argument to provide a directory of pre-sharded VCFs, instead of using the VCF splitting process
// these VCFs should each represent a non-overlapping genome region, each having the same set of  samples
// if null, this is skipped and we use params.vcf, optionally splitting that VCF
// if supplied, we look for files ending with this extension:
params.input_vcf_extension = "vcf.bgz"
params.shards = null

// if a sharded callset isn't provided, give two further options
// 1: a single pre-merged VCF containing all samples, which we will go on to region-filter and split
params.vcf = null

// 2: a directory containing single sample VCFs, which are first merged into a single VCF, then split
// each of these should be accompanied by a tabix index
// the glob for VCFs in this directory uses the extension "params.input_vcf_extension"
params.ss_vcf_dir = null

// input VCF will be split at every n variants, with each chunk running in parallel
// if this value is 0, the whole VCF will be processed as one
params.vcf_split_n = 1000000

// output path for Cohort-specific results
params.cohort_output_dir = "nextflow/${params.cohort}_outputs"

// all outputs which are not specific to a cohort/family/analysis
params.processed_annotations = "nextflow/processed_annotations"

params.large_files = "large_files"
params.ref_genome = "${params.large_files}/ref.fa"

// path to Echtvar-formatted annotation data
// Download this file from https://zenodo.org/records/15222100
// This file does not need to be unzipped!
params.gnomad_zip = "${params.large_files}/gnomad_4.1_region_merged_GRCh38_whole_genome"

// MANE transcript resource
params.mane = "${params.large_files}/MANE.GRCh38.v1.4.summary.txt.gz"
// result file from running ParseManeIntoJson on the MANE summary file
params.mane_json = "${params.processed_annotations}/mane.json"

// Ensembl gene feature file
params.ensembl_gff = "${params.large_files}/Homo_sapiens.GRCh38.115.gff3.gz"
// result files from the CreateRoiFromGff3 nextflow module, implementing the CreateRoiFromGff3 script followed by a sort
params.ensembl_bed = "${params.processed_annotations}/GRCh38.bed"
params.ensembl_merged_bed = "${params.processed_annotations}/GRCh38_merged.bed"

// AlphaMissense annotations reformatted as an echtvar-compatible zip
params.alphamissense_zip = "${params.processed_annotations}/alphamissense.zip"

// Docker image - built from Dockerfile in the root directory
// "docker build -t talos:9.0.2 ."
params.container = 'talos:9.0.2'
docker.enabled = true

process {
    memory = 8.GB
    cpus = 2
    withName: 'SplitVcf' {
        memory = '2 GB'
        cpus = 1
    }
    withName: 'AnnotateCsqWithBcftools' {
        memory = '1 GB'
        cpus = 1
    }
    withName: 'AnnotateWithEchtvar' {
        cpus = 1
        memory = '1 GB'
    }
    withName: 'AnnotatedVcfIntoMatrixTable' {
        memory = '8 GB'
        cpus = 4
    }
    withName: 'NormaliseAndRegionFilterVcf' {
        memory = '1 GB'
        cpus = 1
    }
}
